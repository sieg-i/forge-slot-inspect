// SPDX-License-Identifier: MIT

import "forge-std/Script.sol";
import "forge-std/console2.sol";
import {Token} from "../src/Token.sol";

pragma solidity ^0.8.20;

contract MappingsScript is Script {
    
    function getMappingValue(address targetContract, uint256 mapSlot, address key) public view returns (uint256) {
        bytes32 slotValue = vm.load(targetContract, keccak256(abi.encode(key, mapSlot)));
        return uint256(slotValue);
    }

    // forge script script/Mappings.s.sol:MappingsScript --rpc-url https://rpc.esync.network
    function run() public view {
        Token token = Token(0xae33C49279cf0848dde5f92A2784a0aBA9395FA0);

        uint256 balance = getMappingValue(address(token), 11, 0x1D64ec1f5b1fdC4373C3322394cf623C86792Ac7);
        console2.log("Balance: ", balance);
    }

/*
    to get the storage layout below:
        `forge inspect contracts/RocToken.sol:RocToken storageLayout`

    ╭--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------╮
    | Name                           | Type                                                                | Slot | Offset | Bytes | Contract                        |
    +================================================================================================================================================================+
    | _owner                         | address                                                             | 0    | 0      | 20    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | registryAddress                | address                                                             | 1    | 0      | 20    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | ERC1820REGISTRY                | contract IERC1820Registry                                           | 2    | 0      | 20    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _interfaceHashes               | mapping(bytes32 => bool)                                            | 3    | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _minters                       | struct Roles.Role                                                   | 4    | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | domainSeparators               | mapping(uint256 => bytes32)                                         | 5    | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _name                          | string                                                              | 6    | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _symbol                        | string                                                              | 7    | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _granularity                   | uint256                                                             | 8    | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _totalSupply                   | uint256                                                             | 9    | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _migrated                      | bool                                                                | 10   | 0      | 1     | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _isControllable                | bool                                                                | 10   | 1      | 1     | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _isIssuable                    | bool                                                                | 10   | 2      | 1     | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _balances                      | mapping(address => uint256)                                         | 11   | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _allowed                       | mapping(address => mapping(address => uint256))                     | 12   | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _documents                     | mapping(bytes32 => struct ERC1400.Doc)                              | 13   | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _indexOfDocHashes              | mapping(bytes32 => uint256)                                         | 14   | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _docHashes                     | bytes32[]                                                           | 15   | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _totalPartitions               | bytes32[]                                                           | 16   | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _indexOfTotalPartitions        | mapping(bytes32 => uint256)                                         | 17   | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _totalSupplyByPartition        | mapping(bytes32 => uint256)                                         | 18   | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _partitionsOf                  | mapping(address => bytes32[])                                       | 19   | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _indexOfPartitionsOf           | mapping(address => mapping(bytes32 => uint256))                     | 20   | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _balanceOfByPartition          | mapping(address => mapping(bytes32 => uint256))                     | 21   | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _defaultPartitions             | bytes32[]                                                           | 22   | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _authorizedOperator            | mapping(address => mapping(address => bool))                        | 23   | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _controllers                   | address[]                                                           | 24   | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _isController                  | mapping(address => bool)                                            | 25   | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _allowedByPartition            | mapping(bytes32 => mapping(address => mapping(address => uint256))) | 26   | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _authorizedOperatorByPartition | mapping(address => mapping(bytes32 => mapping(address => bool)))    | 27   | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _controllersByPartition        | mapping(bytes32 => address[])                                       | 28   | 0      | 32    | contracts/RocToken.sol:RocToken |
    |--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------|
    | _isControllerByPartition       | mapping(bytes32 => mapping(address => bool))                        | 29   | 0      | 32    | contracts/RocToken.sol:RocToken |
    ╰--------------------------------+---------------------------------------------------------------------+------+--------+-------+---------------------------------╯
*/
}
